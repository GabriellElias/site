<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contrato de Prestação de Serviço - Espaço para Eventos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Importa a fonte Roboto do Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');

        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 30px; /* Mais padding para um visual mais arejado */
            background-color: #eef2f5; /* Fundo mais claro */
            color: #333;
            line-height: 1.7; /* Melhor espaçamento entre linhas */
        }
        .container {
            max-width: 950px; /* Ligeiramente mais largo */
            margin: 20px auto;
            background-color: #ffffff;
            border-radius: 12px; /* Cantos mais arredondados */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); /* Sombra mais pronunciada */
            padding: 40px; /* Mais padding interno */
            position: relative; /* Para posicionar a logo se necessário */
        }
        .header-logo {
            display: block;
            margin: 0 auto 30px auto; /* Centraliza a logo e adiciona margem inferior */
            max-width: 200px; /* Tamanho máximo da logo */
            height: auto;
        }
        h1, h2, h3 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-weight: 700;
        }
        h1 {
            font-size: 2.5em; /* Fonte maior para o título principal */
            border-bottom: 3px solid #4a90e2; /* Linha azul mais destacada */
            padding-bottom: 15px;
            margin-top: 0;
            letter-spacing: 0.5px; /* Leve espaçamento entre letras */
        }
        h2 {
            font-size: 1.8em; /* Fonte maior para subtítulos de seção */
            color: #34495e;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 35px;
            text-transform: uppercase; /* Maiúsculas para subtítulos */
            letter-spacing: 0.3px;
        }
        h3 {
            font-size: 1.4em; /* Fonte maior para sub-subtítulos */
            color: #34495e;
            margin-top: 28px;
            margin-bottom: 18px;
            border-left: 4px solid #4a90e2; /* Adiciona uma borda lateral */
            padding-left: 10px;
        }
        .section {
            margin-bottom: 40px; /* Mais espaçamento entre seções */
            padding: 25px;
            background-color: #fcfdff; /* Fundo levemente diferente para seções */
            border: 1px solid #dcdcdc;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); /* Sombra mais leve para seções */
        }
        .section p {
            margin-bottom: 12px;
        }
        .field-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Colunas mais largas */
            gap: 25px; /* Mais espaço entre os campos */
            margin-bottom: 20px;
        }
        .field {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
            display: flex;
            align-items: center;
            font-size: 0.95em; /* Tamanho da fonte ligeiramente menor */
        }
        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="number"],
        textarea,
        select {
            width: calc(100% - 22px); /* Ajuste para padding */
            padding: 12px; /* Mais padding */
            border: 1px solid #cdd4da;
            border-radius: 6px; /* Cantos arredondados */
            font-size: 1em;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            background-color: #ffffff;
        }
        input[type="text"]:focus,
        input[type="date"]:focus,
        input[type="time"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            border-color: #4a90e2;
            outline: none;
            box-shadow: 0 0 8px rgba(74, 144, 226, 0.4);
        }
        textarea {
            resize: vertical;
            min-height: 90px;
        }
        .radio-group, .checkbox-group {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 5px; /* Espaçamento para o grupo de rádio/checkbox */
        }
        .radio-group label, .checkbox-group label {
            margin-right: 25px;
            margin-bottom: 0;
            font-weight: normal;
            cursor: pointer;
            font-size: 0.9em;
        }
        .radio-group input[type="radio"], .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.15); /* Checkbox/radio um pouco maiores */
            cursor: pointer;
        }
        .price {
            font-weight: 700;
            color: #27ae60;
            font-size: 1.2em; /* Preço maior */
        }
        .total-value {
            font-size: 1.8em; /* Valor total bem destacado */
            color: #e67e22;
            font-weight: 700;
            text-align: right;
            padding-top: 15px;
            border-top: 2px dashed #cccccc;
            margin-top: 25px;
        }
        .signature-area {
            margin-top: 70px;
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #e0e0e0;
        }
        .signature-line {
            display: inline-block;
            width: 45%; /* Linhas de assinatura um pouco mais longas */
            border-bottom: 1px solid #000;
            margin: 0 15px 45px 15px;
            padding-top: 35px;
            vertical-align: top;
        }
        .disclaimer {
            font-size: 0.88em;
            color: #7f8c8d;
            margin-top: 18px;
            line-height: 1.55;
            text-align: justify; /* Justifica o texto */
        }
        .error-message {
            color: #e74c3c;
            font-size: 0.88em;
            margin-top: 6px;
            font-weight: 500;
        }
        .info-message {
            color: #3498db;
            font-size: 0.88em;
            margin-top: 6px;
            font-weight: 500;
        }
        .read-only-field {
            background-color: #ecf0f1;
            padding: 12px;
            border-radius: 6px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        /* Specific alignment for time inputs */
        .time-inputs {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .time-inputs input {
            width: 130px; /* Adjust width as needed */
        }
        .button-container {
            text-align: center;
            margin-top: 50px; /* Mais espaçamento para o botão */
            margin-bottom: 25px;
        }
        .button-container button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 16px 35px; /* Botão maior */
            font-size: 1.2em; /* Fonte maior no botão */
            border-radius: 9px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15); /* Sombra mais forte para o botão */
        }
        .button-container button:hover {
            background-color: #218838;
            transform: translateY(-3px); /* Efeito de elevação maior */
            box-shadow: 0 9px 20px rgba(0, 0, 0, 0.2);
        }
        .button-container button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        #loading_message {
            font-size: 1.15em;
            color: #3498db;
            margin-top: 18px;
            font-weight: 600;
        }

        /* Styles for the signature checkbox block */
        .contractante-signature-block {
            display: flex; 
            align-items: flex-start;
            justify-content: center;
            max-width: 650px; /* slightly wider for label text */
            margin: 25px auto 50px auto; /* More margin */
            text-align: left;
            padding: 20px;
            border: 1px solid #cdd4da;
            border-radius: 10px;
            background-color: #fdfdfd;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .contractante-signature-block input[type="checkbox"] {
            margin-top: 7px; /* Align checkbox better with text */
            margin-right: 15px;
            transform: scale(1.3); /* Larger checkbox */
            cursor: pointer;
        }
        .contractante-signature-block label {
            font-weight: normal;
            color: #333;
            line-height: 1.5;
            cursor: pointer;
            font-size: 0.95em;
            flex: 1; /* Allows label to take available space */
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LOGO ADICIONADA AQUI -->
        <img src="slogan espaço Comemore jpeg.jpg" alt="Logo Buffet Espaço Comemore" class="header-logo">
        
        <h1>CONTRATO DE PRESTAÇÃO DE SERVIÇO DE ESPAÇO PARA EVENTOS PARTICULARES</h1>

        <div class="section" id="section-contratado">
            <h2>CONTRATADO</h2>
            <div class="field-group">
                <div class="field">
                    <label>NOME:</label>
                    <div class="read-only-field">LEANDRO RUY BATISTA DA SILVA</div>
                </div>
                <div class="field">
                    <label>LOCAL:</label>
                    <div class="read-only-field">BUFFET ESPAÇO COMEMORE FESTAS E EVENTOS.</div>
                </div>
            </div>
            <div class="field-group">
                <div class="field">
                    <label>ENDEREÇO:</label>
                    <div class="read-only-field">RUA ISAURA PARENTE, ESQ., COM A RUA VENEZA, N° 100. (RUA DA PISTA DE TESTE DO DETRAN).</div>
                </div>
                <div class="field">
                    <label>CIDADE:</label>
                    <div class="read-only-field">RIO BRANCO – AC / CEP: 69918-210</div>
                </div>
            </div>
            <div class="field-group">
                <div class="field">
                    <label>CPF:</label>
                    <div class="read-only-field">682.459.552-72</div>
                </div>
                <div class="field">
                    <label>TELEFONE:</label>
                    <div class="read-only-field">(68) 9.99217686 / 9.92414341</div>
                </div>
            </div>
        </div>

        <div class="section" id="section-contratante">
            <h2>CONTRATANTE</h2>
            <div class="field-group">
                <div class="field">
                    <label for="contratante_nome">NOME:</label>
                    <input type="text" id="contratante_nome" name="contratante_nome" placeholder="Nome Completo">
                </div>
                <div class="field">
                    <label for="contratante_cpf">CPF:</label>
                    <input type="text" id="contratante_cpf" name="contratante_cpf" placeholder="000.000.000.00" maxlength="14">
                </div>
            </div>
            <div class="field-group">
                <div class="field">
                    <label for="contratante_telefone">TELEFONE:</label>
                    <input type="text" id="contratante_telefone" name="contratante_telefone" placeholder="(00) 000000000" maxlength="14">
                </div>
                <div class="field">
                    <label for="motivo_evento">MOTIVO DO EVENTO:</label>
                    <input type="text" id="motivo_evento" name="motivo_evento" placeholder="Ex: Aniversário, Casamento">
                </div>
            </div>
            <div class="field-group">
                <div class="field">
                    <label for="contratante_endereco">ENDEREÇO:</label>
                    <input type="text" id="contratante_endereco" name="contratante_endereco" placeholder="Rua, Número, Bairro">
                </div>
                <div class="field">
                    <label for="obs">OBSERVAÇÕES:</label>
                    <textarea id="obs" name="obs" placeholder="Observações adicionais..."></textarea>
                </div>
            </div>
        </div>

        <div class="section" id="section-objetivo">
            <h2>OBJETIVO DO CONTRATO E DETALHES DO EVENTO</h2>
            <p>Prestação de serviço de um ESPAÇO na casa do CONTRATADO com Termo de Consentimento Livre e Esclarecido Pandemia COVID -19 , através da utilização de um espaço para festa particular por tempo limitado conforme especificação abaixo:</p>
            <div class="field-group">
                <div class="field">
                    <label for="data_utilizacao">DATA DA UTILIZAÇÃO:</label>
                    <input type="date" id="data_utilizacao" name="data_utilizacao">
                </div>
                <div class="field">
                    <label>TIPO DE EVENTO:</label>
                    <div class="radio-group">
                        <input type="radio" id="tipo_evento_diurno" name="tipo_evento" value="diurno" checked> <label for="tipo_evento_diurno">Diurno</label>
                        <input type="radio" id="tipo_evento_noturno" name="tipo_evento" value="noturno"> <label for="tipo_evento_noturno">Noturno</label>
                    </div>
                </div>
            </div>

            <div class="field-group">
                <div class="field">
                    <label>HORÁRIO DE UTILIZAÇÃO:</label>
                    <div class="time-inputs">
                        <input type="time" id="horario_inicio" name="horario_inicio"> até
                        <input type="time" id="horario_fim" name="horario_fim">
                    </div>
                    <span id="horario_info" class="info-message"></span>
                    <span id="horario_error" class="error-message"></span>
                </div>
            </div>
            <div class="info-message">
                <p><strong>Horários de Entrega/Decoração:</strong></p>
                <ul>
                    <li>Para eventos diurnos, a entrega de bebidas/decoração pode ser realizada entre 07:00 e 09:00.</li>
                    <li>Para eventos noturnos, a entrega de bebidas/decoração pode ser realizada entre 14:00 e 15:00.</li>
                </ul>
            </div>
            <div class="field-group">
                <div class="field">
                    <label>QUANTIDADE DE MESAS INCLUSAS:</label>
                    <div class="read-only-field">10 (fixas)</div>
                </div>
                <div class="field">
                    <label for="mesas_extras">CADEIRAS EXTRAS (R$10 por cadeira):</label>
                    <input type="number" id="mesas_extras" name="mesas_extras" min="0" value="0">
                    <span id="valor_mesas_extras_display" class="info-message"></span>
                </div>
            </div>

            <div class="field-group">
                <div class="field">
                    <label>VALOR DO ESPAÇO:</label>
                    <span id="valor_espaco_display" class="price">R$ 0,00</span>
                </div>
                <div class="field">
                    <label>UTILIZAÇÃO DA PISCINA:</label>
                    <div class="radio-group">
                        <input type="radio" id="utilizacao_piscina_sim" name="utilizacao_piscina" value="sim"> <label for="utilizacao_piscina_sim">SIM</label>
                        <input type="radio" id="utilizacao_piscina_nao" name="utilizacao_piscina" value="nao" checked> <label for="utilizacao_piscina_nao">NÃO</label>
                    </div>
                    <span id="adicional_piscina_display" class="price"></span>
                </div>
            </div>

            <div class="field-group">
                <div class="field">
                    <label>ADICIONAR PULA PULA (R$90/diária):</label>
                    <div class="radio-group">
                        <input type="radio" id="adicionar_pula_pula_sim" name="adicionar_pula_pula" value="sim"> <label for="adicionar_pula_pula_sim">SIM</label>
                        <input type="radio" id="adicionar_pula_pula_nao" name="adicionar_pula_pula" value="nao" checked> <label for="adicionar_pula_pula_nao">NÃO</label>
                    </div>
                    <span id="valor_pula_pula_display" class="info-message"></span>
                </div>
                <div class="field">
                    <label>ADICIONAR PISCINA DE BOLINHA (R$90/diária):</label>
                    <div class="radio-group">
                        <input type="radio" id="adicionar_piscina_bolinha_sim" name="adicionar_piscina_bolinha" value="sim"> <label for="adicionar_piscina_bolinha_sim">SIM</label>
                        <input type="radio" id="adicionar_piscina_bolinha_nao" name="adicionar_piscina_bolinha" value="nao" checked> <label for="adicionar_piscina_bolinha_nao">NÃO</label>
                    </div>
                    <span id="valor_piscina_bolinha_display" class="info-message"></span>
                </div>
            </div>
            
            <div class="field-group">
                <div class="field" style="grid-column: 1 / -1; text-align: right;">
                    <label>VALOR TOTAL ESTIMADO:</label>
                    <span id="valor_total_display" class="total-value">R$ 0,00</span>
                </div>
            </div>

            <h3>FORMA DE PAGAMENTO</h3>
            <div class="field-group">
                <div class="field">
                    <label>ENTRADA (50% do valor total):</label>
                    <div class="read-only-field">Data: <span id="entrada_data_display"></span> | R$ <span id="entrada_valor_display"></span></div>
                </div>
                <div class="field">
                    <label>RESTANTE (50% do valor total - no dia do evento):</label>
                    <div class="read-only-field">Data: <span id="restante_data_display"></span> | R$ <span id="restante_valor_display"></span></div>
                </div>
                <div class="field">
                    <label>À VISTA (100% do valor total - no dia do evento):</label>
                    <div class="read-only-field">Data: <span id="a_vista_data_display"></span> | R$ <span id="a_vista_valor_display"></span></div>
                </div>
            </div>
        </div>

        <div class="section" id="section-adicionais">
            <h2>ITENS ADICIONAIS AO CONTRATO:</h2>
            <textarea style="width: calc(100% - 20px);" name="itens_adicionais" placeholder="Descreva aqui quaisquer itens adicionais acordados..."></textarea>
        </div>

        <div class="section" id="section-funcionamento">
            <h2>FUNCIONAMENTO DO ESPAÇO PARTICULAR:</h2>
            <p>O Espaço deve ser utilizado no período estabelecido no item "DETALHES DO EVENTO" acima para festa particular na casa do CONTRATADO.</p>
            <p>O Espaço deve ser utilizado nas horas definidas neste contrato e após este horário deverá entregar-se imediatamente as chaves e controles em perfeito estado ao CONTRATADO ou a pessoa indicada pelo mesmo.</p>
            <p>O Espaço deve ser utilizado conforme acordado, com a utilização da piscina (<input type="checkbox">) sim ou (<input type="checkbox">) não, cabendo colocar a capa na piscina(<input type="checkbox">) sim ou (<input type="checkbox">) não. Deve-se cumprir o que foi acordado e zelar pelo bom uso do mesmo.</p>
            <p>- O Espaço deve ser utilizado pelo CONTRATANTE, sendo o espaço individual e intransferível, não podendo o mesmo ser utilizado para festas coletivas por pessoa pagantes.</p>
            <p>O Espaço deve ser entregue diretamente ao CONTRATANTE, cabendo a este cumprir o horário estabelecido para buscar as chaves do espaço, que se dará na data <input type="date" style="width: auto; display: inline-block;">, às <input type="time" style="width: auto; display: inline-block;"> horas.</p>
            <h3>O ESPAÇO SERÁ UTILIZADO:</h3>
            <p>Com a assinatura deste contrato, objeto do presente instrumento, o cliente terá direito ao uso do espaço completo para festas, contendo <span class="read-only-field" style="display: inline-block; padding: 5px 10px;">10</span> mesas, um freezer, fogão industrial, com gás(<input type="checkbox">) ou sem gás (<input type="checkbox">), utilização da piscina (<input type="checkbox">) sim ou (<input type="checkbox">) não, cabendo colocar a capa na piscina (<input type="checkbox">) sim ou (<input type="checkbox">) no. </p>
            <p>Será permitido ser servido comida e bebida no espaço, não sendo permitido de forma alguma a sua utilização no interior da piscina, e qualquer tipo de fogos auditivos e pirotécnicos no espaço, ou qualquer tipo de fogo que possa causar algum risco às pessoas que estejam no ambiente ou até mesmo danos ao ambiente.</p>
            <p>Será permitido o uso de decoração, desde que não cause estragos nas paredes e estrutura, devendo ser totalmente retirada no final do evento.</p>
            <p>Any damage caused must be reimbursed.</p>
            <p class="disclaimer">O horário de disponibilidade do espaço deverá ser rigorosamente cumprido, nos termos do item "DETALHOS DO EVENTO" supra, sendo que em caso de atraso na devolução acarretará na cobrança de multa no valor correspondente 1/3 do valor por hora, não ultrapassando mais de 2 horas de atraso, sob pena de acionamento policial para retirada.</p>
        </div>

        <div class="section" id="section-obrigacoes-contratado">
            <h2>DAS OBRIGAÇÕES DO CONTRATADO:</h2>
            <p>O CONTRATADO se obriga a ceder o espaço para uso da festa no período estabelecido no item "DETALHES DO EVENTO", todo limpo, com banheiro completo com papel higiênico, papel toalha e sabonete líquido, a piscina limpa, churrasqueira limpa e pias em general limpas, freezer já ligada, e chaves dos ambientes.</p>
            <p>O CONTRATADO não se responsabiliza nem internamente e externamente, pela segurança do ambiente, sendo de total responsabilidade do CONTRATANTE, sendo que o CONTRATADO, dispõe de segurança do ambiente com valores acordados.</p>
            <p>O CONTRATADO não se responsabiliza pela guarda das crianças e adolescentes convidados, devendo os mesmos estarem acompanhados dos pais e responsáveis, inclusive ao redor da piscina e ao adentrar na piscina.</p>
            <p>Fica estabelecido neste instrumento de contrato que o CONTRATADO é somente responsável pela entrega no ambiente limpo ao CONTRATANTE de acordo com os recursos disponíveis no seu estabelecimento.</p>
        </div>

        <div class="section" id="section-obrigacoes-contratante">
            <h2>DAS OBRIGAÇÕES DO CONTRATANTE:</h2>
            <p>As crianças e adolescentes deverão estar acompanhadas dos pais ou responsáveis, cabendo à CONTRATANTE a guarda e cuidados dos menores.</p>
            <p>O valor cobrado pelo espaço deverá ser dado uma entrada de 50% no ato da reserva e mais 50% até 5 dias antes do evento, através de moeda corrente nacional.</p>
            <p>Não será aceito como pagamento o recebimento de cheques à vista ou pós-datado, de acordo com o Art. 5°, II da CF/88.</p>
            <p>A CONTRATANTE é responsável por orientar os decoradores ou demais fornecedores contratados para não utilizarem grampos, adesivos e colas que danifiquem as paredes, bem como ficará responsável por toda parte interna do espaço: banheiros, pintura, churrasqueira, fogão, piso em general, teto e ou lona decorativa, sob pena de arcarem com os prejuízos causados.</p>
            <p>É de obrigação do CONTRATANTE estar pontualmente no horário determinado no contrato, para buscar as chaves do espaço, visto que não havendo atrasos e ou retrocessos no horário contratado.</p>
        </div>

        <div class="section" id="section-cancelamento">
            <h2>CANCELAMENTO OU ALTERAÇÃO DE DATA:</h2>
            <p>Caso o CONTRATANTE deseje efetuar o cancelamento ou alteração de data, somente poderá ser feito com prazo mínimo de 7 dias antes da data contratada para utilização do espaço, COM PAGAMENTO DE MULTA REFERENTE A 40% DO VALOR CONTRATADO, sendo consultada nova data, se houver disponibilidade e se encaixa no mesmo valor do CONTRATANTE.</p>
            <p>Se o CONTRATANTE quiser cancelar será devolvido o valor somente de 10% do valor já pago, o restante ficará como título de multa, no prazo de 15 dias após a sua solicitação.</p>
            <p>Caso a solicitação de cancelamento ou alteração se dê com menos de 7 dias, não caberá restituição dos valores pagos.</p>
            <p>Qualquer alteração na data ou horário agendado só poderá ser efetuada através da assinatura de um novo contrato.</p>
            <p>Qualquer alteração nas datas e horários inicialmente acordados está condicionada à disponibilidade de agenda do CONTRATADO.</p>
        </div>

        <div class="section" id="section-informacoes-gerais">
            <h2>INFORMAÇÕES GERAIS:</h2>
            <p>O CONTRATANTE tem a ciência de que o espaço é uma área residencial, cabendo, se alguém procurar o proprietário, informar ao mesmo para ligar no número que se encontra no espaço, que seria a sua fácil localização.</p>
            <p>O CONTRATANTE deverá ter ciência, e será responsável quanto à utilização de som, que após às 22:00 horas, cabendo ao mesmo se informar sobre a sua utilização e altura adequada após este horário, pois se trata o local de uma área residencial.</p>
            <p>O CONTRATADO não se responsabiliza por perda ou objetos perdidos ou esquecidos no interior do espaço.</p>
            <p>O total de pessoas no espaço é de aproximadamente 120 (cento e vinte pessoas), o CONTRATADO não consente com pessoas a mais que este total.</p>
            <p>Na falta de energia, que compromete a realização do evento, o CONTRATADO não se responsabiliza por isso, pois não é culpa por parte deste CONTRATADO, não sendo ressarcido de maneira nenhuma o dinheiro de volta.</p>
            <p>Qualquer dano causado ao ambiente, deverá ser ressarcido.</p>
            <p class="disclaimer">As questões decorrentes deste contrato serão resolvidas mediante entendimentos entre as partes, ficando eleito, para o caso de insucesso, o FORO DA COMARCA DE RIO BRANCO/AC, para dirimi-las.</p>
            <p class="disclaimer">E por estarem justas e contratadas, as partes firmam o presente instrumento em 02 vias de igual teor e forma, para uma só finalidade.</p>
            <p>RIO BRANCO, AC <span id="data_contrato_final"></span>.</p>
        </div>

        <!-- A Área de Assinatura foi movida para um bloco próprio -->
        <div class="signature-area" id="pdf-signature-area">
            <h2 style="margin-top: 0;">ASSINATURAS</h2>
            <p style="margin-bottom: 30px;">Por estarem justos e contratados, as partes assinam o presente instrumento.</p>
            <div class="contractante-signature-block">
                <input type="checkbox" id="agree_terms">
                <label for="agree_terms">
                    Ao assinalar este bloco, declaro que li, compreendi e concordo com todas as exigências deste contrato, e estou ciente de suas condições, valendo esta seleção como minha assinatura.
                </label>
            </div>
            
            <div class="signature-line"></div>
            <p>CONTRATADO</p>
            <p class="disclaimer">Rua Veneza. ESQ. Rua Isaura Parente, 100. (Rua da pista de teste do DETRAN). Fone/Whatsapp: (68) 99921.7686 – espacocomemoreacre@gmail.com</p>
        </div>

        <div class="section" id="section-termo-consentimento">
            <h2>Termo de Consentimento Livre e Esclarecido - Pandemia COVID-19</h2>
            <p>EU, <input type="text" style="width: 200px; display: inline-block;" id="nome_termo_consentimento" placeholder="Nome Completo">, CPF. <input type="text" style="width: 150px; display: inline-block;" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="___ . ___ . ___ - __" id="cpf_termo_consentimento">. fui devidamente esclarecido(a) pelo PROPRIETARIO, sobre a pandemia de COVID-19, também chamada de novo coronavírus, que estamos vivendo, bem como dos riscos a que estarei exposto em relação a isso.</p>
            <p>Estou informado e compreendi que durante o período de UTILIZAÇÃO DO ESPAÇO (antes, durante e após utilização) estarei exposto a eventuais contaminações pela COVID-19 por contato com qualquer pessoa portador do novo coronavírus, mesmo que assintomáticos e não sabedores de suas condições, e que isso poderá acarretar o desenvolvimento de sintomas variados com diferentes graus de gravidade.</p>
            <p>Desta forma, opto por continuar com a UTILIZAÇÃO DO ESPAÇO, uma vez que fui orientado(a) sobre as medidas de precaução e de prevenção, principalmente quanto à utilização de USO DE MÁSCARA, LAVAR AS MÃOS SEMPRE QUE POSSÍVEL, MANTER UMA DISTÂNCIA SEGURA E UTILIZAÇÃO DE ÁLCOOL 70% EM GEL.</p>
            <p>Assim sendo, DECLARO que fui orientado, pela própria mídia, pelas redes sociais entre outras formas de informação em relação ao cuidados que devo tomar, principalmente quanto à higiene pessoal, alimentação, comportamento social, evitando aglomeração ou com fluxo intenso de pessoas.</p>
            <p>Ciente dos riscos e benefícios, bem como dirimidas todas as dúvidas, aceito realizar o evento.</p>
            <p>Rio Branco, <span id="dia_termo_consentimento" style="display: inline-block; width: 40px; text-align: center;"></span> de <span id="mes_termo_consentimento" style="display: inline-block; width: 80px; text-align: center;"></span> de <span id="ano_termo_consentimento" style="display: inline-block; width: 50px; text-align: center;"></span>.</p>
        </div>

        <div class="button-container">
            <button id="enviar_contrato_btn">Salvar Contrato como PDF</button>
            <div id="loading_message" style="display: none;">Gerando PDF... Por favor, aguarde.</div>
            <span id="pdf_error_message" class="error-message"></span>
        </div>
    </div>

    <script>
        // --- Functions to disable developer tools ---
        function disableDevTools() {
            // Desabilita o menu de contexto (botão direito do mouse)
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                console.log("Clique com o botão direito desabilitado.");
            });

            // Desabilita atalhos de teclado comuns para ferramentas de desenvolvedor
            document.addEventListener('keydown', function(e) {
                // F12
                if (e.keyCode == 123) {
                    e.preventDefault();
                    console.log("F12 desabilitado.");
                }
                // Ctrl+Shift+I (Windows/Linux) ou Cmd+Option+I (Mac)
                if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                    e.preventDefault();
                    console.log("Ctrl+Shift+I desabilitado.");
                }
                // Ctrl+Shift+J (Windows/Linux) ou Cmd+Option+J (Mac)
                if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                    e.preventDefault();
                    console.log("Ctrl+Shift+J desabilitado.");
                }
                // Ctrl+U (Ver Código Fonte)
                if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                    e.preventDefault();
                    console.log("Ctrl+U desabilitado.");
                }
                // Ctrl+Shift+C (Inspecionar Elemento)
                if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                    e.preventDefault();
                    console.log("Ctrl+Shift+C desabilitado.");
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Chama a função para desabilitar as ferramentas de desenvolvedor no carregamento da página
            disableDevTools();

            const dataUtilizacaoInput = document.getElementById('data_utilizacao');
            const tipoEventoRadios = document.querySelectorAll('input[name="tipo_evento"]');
            const horarioInicioInput = document.getElementById('horario_inicio');
            const horarioFimInput = document.getElementById('horario_fim');
            const horarioInfoSpan = document.getElementById('horario_info');
            const horarioErrorSpan = document.getElementById('horario_error');
            const mesasExtrasInput = document.getElementById('mesas_extras');
            const valorMesasExtrasDisplay = document.getElementById('valor_mesas_extras_display');
            const valorEspacoDisplay = document.getElementById('valor_espaco_display');
            const utilizacaoPiscinaSim = document.getElementById('utilizacao_piscina_sim');
            const utilizacaoPiscinaNao = document.getElementById('utilizacao_piscina_nao');
            const adicionalPiscinaDisplay = document.getElementById('adicional_piscina_display');
            const adicionarPulaPulaSim = document.getElementById('adicionar_pula_pula_sim');
            const adicionarPulaPulaNao = document.getElementById('adicionar_pula_pula_nao');
            const valorPulaPulaDisplay = document.getElementById('valor_pula_pula_display');
            const adicionarPiscinaBolinhaSim = document.getElementById('adicionar_piscina_bolinha_sim');
            const adicionarPiscinaBolinhaNao = document.getElementById('adicionar_piscina_bolinha_nao');
            const valorPiscinaBolinhaDisplay = document.getElementById('valor_piscina_bolinha_display');
            const valorTotalDisplay = document.getElementById('valor_total_display');
            const entradaDataDisplay = document.getElementById('entrada_data_display');
            const entradaValorDisplay = document.getElementById('entrada_valor_display');
            const restanteDataDisplay = document.getElementById('restante_data_display');
            const restanteValorDisplay = document.getElementById('restante_valor_display');
            const aVistaDataDisplay = document.getElementById('a_vista_data_display');
            const aVistaValorDisplay = document.getElementById('a_vista_valor_display');
            const agreeTermsCheckbox = document.getElementById('agree_terms');

            // Termo de Consentimento
            const nomeTermoConsentimento = document.getElementById('nome_termo_consentimento');
            const cpfTermoConsentimento = document.getElementById('cpf_termo_consentimento');
            const diaTermoConsentimento = document.getElementById('dia_termo_consentimento');
            const mesTermoConsentimento = document.getElementById('mes_termo_consentimento');
            const anoTermoConsentimento = document.getElementById('ano_termo_consentimento');

            // PDF Generation elements
            const enviarContratoBtn = document.getElementById('enviar_contrato_btn');
            const loadingMessage = document.getElementById('loading_message');
            const pdfErrorMessage = document.getElementById('pdf_error_message');

            // Input fields for masking
            const contratanteCpfInput = document.getElementById('contratante_cpf');
            const contratanteTelefoneInput = document.getElementById('contratante_telefone');


            const VALOR_CADEIRA_EXTRA = 10;
            const VALOR_PULA_PULA = 90;
            const VALOR_PISCINA_BOLINHA = 90;
            const VALOR_ADICIONAL_PISCINA_FIXO = 150;
            const VALOR_HORA_EXTRA_DIURNO = 50;

            const MESES = [
                "janeiro", "fevereiro", "março", "abril", "maio", "junho",
                "julho", "agosto", "setembro", "outubro", "novembro", "dezembro"
            ];

            function formatCurrency(value) {
                return `R$ ${value.toFixed(2).replace('.', ',')}`;
            }

            function formatDate(date) {
                const d = String(date.getDate()).padStart(2, '0');
                const m = String(date.getMonth() + 1).padStart(2, '0');
                const y = date.getFullYear();
                return `${d}/${m}/${y}`;
            }

            function timeToMinutes(timeString) {
                if (!timeString) return null;
                const [hour, minute] = timeString.split(':').map(Number);
                return hour * 60 + minute;
            }

            // Function to update min/max attributes and info message on time inputs
            function updateTimeRestrictions() {
                const dataUtilizacao = dataUtilizacaoInput.value;
                const tipoEvento = document.querySelector('input[name="tipo_evento"]:checked').value;

                horarioErrorSpan.textContent = ''; // Clear errors when restrictions are updated
                horarioInfoSpan.textContent = ''; // Clear info message before setting new one

                if (!dataUtilizacao) {
                    horarioInicioInput.value = ''; // Clear value
                    horarioFimInput.value = ''; // Clear value
                    horarioInicioInput.removeAttribute('min');
                    horarioInicioInput.removeAttribute('max');
                    horarioFimInput.removeAttribute('min');
                    horarioFimInput.removeAttribute('max');
                    horarioErrorSpan.textContent = 'Por favor, selecione a data para definir os horários disponíveis.';
                    return;
                }

                const date = new Date(dataUtilizacao + 'T00:00:00');
                const diaSemana = date.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday

                let minTimeStart = '';
                let maxTimeStart = '';
                let minTimeEnd = '';
                let maxTimeEnd = '';
                let infoMessage = '';

                if (tipoEvento === 'diurno') {
                    minTimeStart = '09:00';
                    maxTimeStart = '17:00'; // Não pode iniciar depois das 17:00 para diurno
                    minTimeEnd = '09:00';
                    maxTimeEnd = '22:00'; // Horário limite para término (com adicional)
                    infoMessage = 'Horários permitidos para início: 09:00h até 17:00h. Horário de término pode ir até 22:00h com adicional de R$50/hora após 17:00h.';
                } else { // Noturno
                    minTimeStart = '17:00';
                    maxTimeStart = '23:59'; // Pode iniciar até o final do dia

                    minTimeEnd = '17:00'; // End time generally after 17:00
                    if (diaSemana >= 1 && diaSemana <= 4) { // Monday to Thursday
                        maxTimeEnd = '23:59'; // End of day for input type="time". Actual limit is 00:00 next day
                        infoMessage = 'Horários permitidos: 17:00h até 00:00h (do dia seguinte). Som ambiente após 22:00h.';
                    } else if (diaSemana === 5 || diaSemana === 0) { // Friday or Sunday
                        maxTimeEnd = '23:59'; // Actual limit is 01:00 next day
                        infoMessage = 'Horários permitidos: 17:00h até 01:00h (do dia seguinte). Som ambiente após 22:00h.';
                    } else if (diaSemana === 6) { // Saturday
                        maxTimeEnd = '23:59'; // Actual limit is 02:00 next day
                        infoMessage = 'Horários permitidos: 17:00h até 02:00h (do dia seguinte). Som ambiente após 22:00h.';
                    }
                }

                // Set min/max attributes
                horarioInicioInput.setAttribute('min', minTimeStart);
                horarioInicioInput.setAttribute('max', maxTimeStart);
                horarioFimInput.setAttribute('min', minTimeEnd);
                horarioFimInput.setAttribute('max', maxTimeEnd);
                horarioInfoSpan.textContent = infoMessage;

                // Clear current values if they are now invalid based on new restrictions
                const currentInicioMin = timeToMinutes(horarioInicioInput.value);
                const currentFimMin = timeToMinutes(horarioFimInput.value);
                
                const newMinStart = timeToMinutes(minTimeStart);
                const newMaxStart = timeToMinutes(maxTimeStart);
                const newMinEnd = timeToMinutes(minTimeEnd);
                const newMaxEnd = timeToMinutes(maxTimeEnd);


                if (currentInicioMin !== null && (currentInicioMin < newMinStart || currentInicioMin > newMaxStart)) {
                    horarioInicioInput.value = '';
                }
                if (currentFimMin !== null && (currentFimMin < newMinEnd || currentFimMin > newMaxEnd)) {
                    horarioFimInput.value = '';
                }


                // Re-calculate after setting new restrictions, as current value might become invalid
                calculateTotal();
            }


            function calculateTotal() {
                let total = 0;
                let valorEspaco = 0;
                let diaSemana = -1; // -1 for unselected date
                const dataUtilizacao = dataUtilizacaoInput.value;
                const tipoEvento = document.querySelector('input[name="tipo_evento"]:checked').value;

                if (dataUtilizacao) {
                    const date = new Date(dataUtilizacao + 'T00:00:00');
                    diaSemana = date.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday

                    if (diaSemana >= 1 && diaSemana <= 4) { // Monday to Thursday
                        valorEspaco = 400;
                    } else if (diaSemana === 5 || diaSemana === 0) { // Friday or Sunday
                        valorEspaco = 450;
                    } else if (diaSemana === 6) { // Saturday
                        valorEspaco = 550;
                    }
                }
                valorEspacoDisplay.textContent = formatCurrency(valorEspaco);
                total += valorEspaco;

                const mesasExtras = parseInt(mesasExtrasInput.value) || 0;
                const valorMesasExtras = mesasExtras * VALOR_CADEIRA_EXTRA;
                valorMesasExtrasDisplay.textContent = mesasExtras > 0 ? `(${formatCurrency(valorMesasExtras)} por ${mesasExtras} cadeiras extras)` : '';
                total += valorMesasExtras;

                if (utilizacaoPiscinaSim.checked) {
                    adicionalPiscinaDisplay.textContent = `(Adicional: ${formatCurrency(VALOR_ADICIONAL_PISCINA_FIXO)})`;
                    total += VALOR_ADICIONAL_PISCINA_FIXO;
                } else {
                    adicionalPiscinaDisplay.textContent = '';
                }

                if (adicionarPulaPulaSim.checked) {
                    valorPulaPulaDisplay.textContent = `(Adicional: ${formatCurrency(VALOR_PULA_PULA)})`;
                    total += VALOR_PULA_PULA;
                } else {
                    valorPulaPulaDisplay.textContent = '';
                }

                if (adicionarPiscinaBolinhaSim.checked) {
                    valorPiscinaBolinhaDisplay.textContent = `(Adicional: ${formatCurrency(VALOR_PISCINA_BOLINHA)})`;
                    total += VALOR_PISCINA_BOLINHA;
                } else {
                    valorPiscinaBolinhaDisplay.textContent = '';
                }

                // Handle time validation and additional costs
                const inicioMin = timeToMinutes(horarioInicioInput.value);
                const fimMin = timeToMinutes(horarioFimInput.value);
                horarioErrorSpan.textContent = ''; // Clear specific error messages
                let isValidTime = true;

                if (inicioMin === null || fimMin === null || diaSemana === -1) {
                    isValidTime = false; // Error message handled by updateTimeRestrictions if date is not selected
                } else {
                    let effectiveFimMin = fimMin;
                    // Adjust fimMin for overnight cases (if end is numerically less than start for a nighttime event)
                    if (tipoEvento === 'noturno' && fimMin <= inicioMin) { // Para noturno, pode cruzar meia noite
                        effectiveFimMin += 24 * 60; // Adiciona 24h para facilitar a comparação
                    }
                    
                    if (tipoEvento === 'diurno') {
                        const LIMIT_START_DIURNO = timeToMinutes('09:00');
                        const LIMIT_END_DIURNO_BASE = timeToMinutes('17:00');
                        const LIMIT_END_DIURNO_MAX_ABS = timeToMinutes('22:00'); 

                        if (inicioMin < LIMIT_START_DIURNO || inicioMin >= LIMIT_END_DIURNO_BASE) {
                            horarioErrorSpan.textContent = 'ERRO: Para eventos diurnos, o horário de início deve ser entre 09:00h e antes das 17:00h.';
                            isValidTime = false;
                        } else if (fimMin < inicioMin || effectiveFimMin > LIMIT_END_DIURNO_MAX_ABS) { // fimMin < inicioMin for same-day validation
                            horarioErrorSpan.textContent = 'ERRO: Para eventos diurnos, o horário de término não pode ser anterior ao de início ou ultrapassar 22:00h.';
                            isValidTime = false;
                        } else if (effectiveFimMin > LIMIT_END_DIURNO_BASE) {
                            let extraMinutes = effectiveFimMin - LIMIT_END_DIURNO_BASE;
                            let extraHours = Math.ceil(extraMinutes / 60);
                            let additionalCost = extraHours * VALOR_HORA_EXTRA_DIURNO;
                            total += additionalCost;
                            horarioInfoSpan.textContent = `Custo adicional de ${formatCurrency(additionalCost)} por extensão de horário (após 17:00h). Somente até 22:00h.`;
                        } else {
                            // Ensure info message is reset if it was previously an error but now is valid
                            horarioInfoSpan.textContent = 'Horário diurno válido. (Limites: 09:00h - 22:00h com adicional após 17:00h)';
                        }
                    } else if (tipoEvento === 'noturno') {
                        const LIMIT_START_NOTURNO = timeToMinutes('17:00');
                        let maxAllowedEndTimeMinutes;
                        let maxAllowedEndTimeString;

                        // Calculate true max allowed end time considering next day
                        if (diaSemana >= 1 && diaSemana <= 4) { // Monday to Thursday: 17:00 to 00:00 (next day)
                            maxAllowedEndTimeMinutes = timeToMinutes('00:00') + 24 * 60; 
                            maxAllowedEndTimeString = '00:00 (do dia seguinte)';
                        } else if (diaSemana === 5 || diaSemana === 0) { // Friday or Sunday
                            maxAllowedEndTimeMinutes = timeToMinutes('01:00') + 24 * 60;
                            maxAllowedEndTimeString = '01:00 (do dia seguinte)';
                        } else if (diaSemana === 6) { // Saturday
                            maxAllowedEndTimeMinutes = timeToMinutes('02:00') + 24 * 60;
                            maxAllowedEndTimeString = '02:00 (do dia seguinte)';
                        } else {
                            horarioErrorSpan.textContent = 'ERRO: Data inválida para eventos noturnos.';
                            isValidTime = false;
                        }

                        if (inicioMin < LIMIT_START_NOTURNO || effectiveFimMin > maxAllowedEndTimeMinutes) {
                             horarioErrorSpan.textContent = `ERRO: Para eventos noturnos, o horário permitido é de 17:00h até ${maxAllowedEndTimeString}.`;
                            isValidTime = false;
                        } else if (effectiveFimMin <= inicioMin) { // End must be strictly after start, even for overnight
                            horarioErrorSpan.textContent = 'ERRO: O horário de término deve ser posterior ao horário de início.';
                            isValidTime = false;
                        } else {
                            horarioInfoSpan.textContent = 'Horário noturno válido. Som ambiente após 22:00h.';
                        }
                    }
                }

                if (!isValidTime) {
                    total = 0; // Invalidate total if time is invalid
                    valorTotalDisplay.textContent = formatCurrency(0);
                    updatePaymentDetails(0, dataUtilizacao);
                    return;
                }

                valorTotalDisplay.textContent = formatCurrency(total);
                updatePaymentDetails(total, dataUtilizacao);
            }

            function updatePaymentDetails(total, eventDateStr) {
                const entradaValue = (total / 2);
                const restanteValue = (total / 2);
                const aVistaValue = total;

                entradaValorDisplay.textContent = formatCurrency(entradaValue);
                restanteValorDisplay.textContent = formatCurrency(restanteValue);
                aVistaValorDisplay.textContent = formatCurrency(aVistaValue);

                if (eventDateStr) {
                    const eventDate = new Date(eventDateStr + 'T00:00:00');
                    const entradaDate = new Date(eventDate);
                    entradaDate.setDate(eventDate.getDate() - 5);

                    entradaDataDisplay.textContent = formatDate(entradaDate);
                    restanteDataDisplay.textContent = formatDate(eventDate);
                    aVistaDataDisplay.textContent = formatDate(eventDate);

                    const currentDate = new Date();
                    document.getElementById('data_contrato_final').textContent = formatDate(currentDate);

                    // For consent form date
                    diaTermoConsentimento.textContent = String(currentDate.getDate()).padStart(2, '0');
                    mesTermoConsentimento.textContent = MESES[currentDate.getMonth()];
                    anoTermoConsentimento.textContent = currentDate.getFullYear();

                } else {
                    entradaDataDisplay.textContent = 'DD/MM/AAAA';
                    restanteDataDisplay.textContent = 'DD/MM/AAAA';
                    aVistaDataDisplay.textContent = 'DD/MM/AAAA';
                    document.getElementById('data_contrato_final').textContent = 'DD/MM/AAAA';
                    diaTermoConsentimento.textContent = '...';
                    mesTermoConsentimento.textContent = '...';
                    anoTermoConsentimento.textContent = '....';
                }
            }

            // --- Masking functions for CPF and Telefone ---
            function maskCPF(value) {
                value = value.replace(/\D/g, ''); // Remove tudo o que não é dígito
                value = value.substring(0, 11); // Limita a 11 dígitos para CPF

                if (value.length > 9) {
                    value = value.replace(/^(\d{3})(\d{3})(\d{3})(\d{2})$/, '$1.$2.$3.$4');
                } else if (value.length > 6) {
                    value = value.replace(/^(\d{3})(\d{3})(\d{3})$/, '$1.$2.$3');
                } else if (value.length > 3) {
                    value = value.replace(/^(\d{3})(\d{3})$/, '$1.$2');
                }
                return value;
            }
            
            function maskPhone(value) {
                value = value.replace(/\D/g, ''); // Remove tudo o que não é dígito
                value = value.substring(0, 11); // Limita a 11 dígitos para telefone (com DDD e 9º dígito)

                if (value.length > 2) {
                    value = value.replace(/^(\d{2})(\d)/g, '($1) $2'); // (DD) X
                }
                if (value.length > 9) { // (DD) 9XXXX-XXXX
                    value = value.replace(/(\d{5})(\d{4})$/, '$1-$2'); // Add hyphen for mobile phones
                }
                return value;
            }

            // --- Event Listeners for calculations and restrictions ---
            dataUtilizacaoInput.addEventListener('change', function() {
                updateTimeRestrictions();
                calculateTotal();
            });
            horarioInicioInput.addEventListener('change', calculateTotal);
            horarioFimInput.addEventListener('change', calculateTotal);
            mesasExtrasInput.addEventListener('input', calculateTotal);

            tipoEventoRadios.forEach(radio => radio.addEventListener('change', function() {
                updateTimeRestrictions(); // Update min/max when event type changes
                calculateTotal();
            }));

            utilizacaoPiscinaSim.addEventListener('change', calculateTotal);
            utilizacaoPiscinaNao.addEventListener('change', calculateTotal);
            adicionarPulaPulaSim.addEventListener('change', calculateTotal);
            adicionarPulaPulaNao.addEventListener('change', calculateTotal);
            adicionarPiscinaBolinhaSim.addEventListener('change', calculateTotal);
            adicionarPiscinaBolinhaNao.addEventListener('change', calculateTotal);

            // --- Event Listeners for Masking ---
            contratanteCpfInput.addEventListener('input', function(e) {
                e.target.value = maskCPF(e.target.value);
                // Also update the consent form CPF field
                cpfTermoConsentimento.value = e.target.value;
            });
            contratanteTelefoneInput.addEventListener('input', function(e) {
                e.target.value = maskPhone(e.target.value);
            });


            // Auto-fill for consent form
            document.getElementById('contratante_nome').addEventListener('input', function() {
                nomeTermoConsentimento.value = this.value;
            });

            // PDF Generation Logic
            enviarContratoBtn.addEventListener('click', async function() {
                pdfErrorMessage.textContent = ''; // Clear previous errors
                loadingMessage.style.display = 'block';
                enviarContratoBtn.disabled = true;

                try {
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4'); // 'p' for portrait, 'mm' for millimeters, 'a4' size
                    const A4_WIDTH_MM = pdf.internal.pageSize.getWidth(); // 210mm
                    const A4_HEIGHT_MM = pdf.internal.pageSize.getHeight(); // 297mm
                    const PDF_MARGIN_TOP_CONTENT = 25; // Adjusted top margin for content below the logo (in mm)

                    // Placeholder Base64 for the logo.
                    // This is a very small, transparent PNG Base64.
                    // IMPORTANT: Replace this with the actual Base64 string of your 'slogan espaço Comemore jpeg.jpg' image.
                    // You can convert your image to Base64 using online tools (e.g., base64-image.de).
                    const LOGO_BASE64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";
                    console.log("LOGO_BASE64 is set:", LOGO_BASE64.substring(0, 50) + "..."); // Log first 50 chars for verification

                    const LOGO_WIDTH_MM = 50; // Adjust as needed
                    const LOGO_HEIGHT_MM = 15; // Adjust as needed
                    const LOGO_X_POS_MM = (A4_WIDTH_MM - LOGO_WIDTH_MM) / 2; // Center horizontally
                    const LOGO_Y_POS_MM = 5; // Top margin for logo

                    // Define groups of sections for PDF pages as per new requirements
                    const pageGroups = [
                        // Página 1: Título + Contratado + Contratante
                        [
                            document.querySelector('h1'),
                            document.getElementById('section-contratado'),
                            document.getElementById('section-contratante')
                        ],
                        // Página 2: Objetivo (inclui forma de pagamento) + Itens Adicionais
                        [
                            document.getElementById('section-objetivo'),
                            document.getElementById('section-adicionais')
                        ],
                        // Página 3 (Consolidada): Funcionamento + Obrigações do Contratado + Obrigações do Contratante
                        [
                            document.getElementById('section-funcionamento'),
                            document.getElementById('section-obrigacoes-contratado'),
                            document.getElementById('section-obrigacoes-contratante')
                        ],
                        // Página 4: Cancelamento + Informações Gerais + Assinaturas
                        [
                            document.getElementById('section-cancelamento'),
                            document.getElementById('section-informacoes-gerais'), 
                            document.getElementById('pdf-signature-area')
                        ],
                        // Página 5: Termo de Consentimento
                        [document.getElementById('section-termo-consentimento')]
                    ];
                    
                    // Temporarily hide the button and loading message for the capture
                    enviarContratoBtn.style.display = 'none';
                    loadingMessage.style.display = 'none';

                    // Process each group independently
                    for (let i = 0; i < pageGroups.length; i++) {
                        const currentGroupElements = pageGroups[i];
                        
                        // Create a temporary div to assemble the HTML for this group
                        const tempDiv = document.createElement('div');
                        // Apply main container styles to tempDiv to maintain layout in capture
                        // We copy essential styles that affect layout and rendering for accurate capture
                        tempDiv.style.maxWidth = '950px'; 
                        tempDiv.style.padding = '8mm'; // Increased padding for more border spacing
                        tempDiv.style.backgroundColor = '#ffffff';
                        tempDiv.style.fontFamily = 'Roboto, Arial, sans-serif';
                        tempDiv.style.lineHeight = '1.1'; // Slightly less compact line height
                        tempDiv.style.boxSizing = 'border-box'; 

                        tempDiv.style.position = 'absolute';
                        tempDiv.style.left = '-9999px'; // Move off-screen
                        // Match the actual rendered width of the main container for consistent scaling
                        tempDiv.style.width = document.querySelector('.container').offsetWidth + 'px'; 
                        document.body.appendChild(tempDiv);

                        // Append clones of the group's HTML elements to tempDiv
                        currentGroupElements.forEach(element => {
                            if (element) { // Check if element exists before cloning
                                const clonedElement = element.cloneNode(true);
                                // Otimizar estilos para a captura do PDF para minimizar espaços em branco
                                clonedElement.style.margin = '0';
                                clonedElement.style.padding = '0';
                                
                                // Reduzir margens e paddings de elementos internos para compactação agressiva
                                clonedElement.querySelectorAll('p, ul, li').forEach(el => {
                                    el.style.marginBottom = '4px'; // Slightly increased margin
                                    el.style.marginTop = '4px';
                                    el.style.lineHeight = '1.2'; // Slightly increased line height
                                    el.style.fontSize = '0.92em'; // Slightly larger font
                                });
                                clonedElement.querySelectorAll('h1, h2, h3').forEach(el => {
                                    el.style.marginBottom = '10px'; // Increased margin
                                    el.style.marginTop = '12px'; // Increased margin
                                    el.style.borderBottom = 'none'; 
                                    el.style.paddingBottom = '0';
                                    el.style.fontSize = (parseFloat(getComputedStyle(el).fontSize) * 0.95) + 'px'; // Slightly larger font
                                });
                                clonedElement.querySelectorAll('.section').forEach(el => {
                                    el.style.padding = '12px'; // Increased padding
                                    el.style.marginBottom = '18px'; // Increased margin
                                });
                                clonedElement.querySelectorAll('.field-group').forEach(el => {
                                    el.style.marginBottom = '12px'; // Increased margin
                                    el.style.gap = '20px'; // Increased gap
                                });
                                clonedElement.querySelectorAll('.field label').forEach(el => {
                                    el.style.marginBottom = '6px'; // Increased margin
                                    el.style.fontSize = '0.9em'; // Slightly larger font
                                });
                                clonedElement.querySelectorAll('input, textarea, .read-only-field').forEach(el => {
                                    el.style.padding = '8px'; // Increased padding
                                    el.style.fontSize = '0.95em'; // Slightly larger font
                                    el.style.marginBottom = '6px';
                                });
                                clonedElement.querySelectorAll('.total-value').forEach(el => {
                                    el.style.paddingTop = '8px';
                                    el.style.marginTop = '15px';
                                    el.style.fontSize = '1.5em'; // Slightly larger font
                                });
                                clonedElement.querySelectorAll('.info-message, .disclaimer').forEach(el => {
                                    el.style.fontSize = '0.85em'; // Slightly larger font
                                    el.style.lineHeight = '1.2';
                                    el.style.marginBottom = '8px';
                                    el.style.marginTop = '8px';
                                });
                                clonedElement.querySelectorAll('.signature-area').forEach(el => {
                                    el.style.marginTop = '40px'; // Increased margin
                                    el.style.paddingTop = '20px';
                                });
                                clonedElement.querySelectorAll('.contractante-signature-block').forEach(el => {
                                    el.style.padding = '15px'; // Increased padding
                                    el.style.marginTop = '20px';
                                    el.style.marginBottom = '30px';
                                });


                                tempDiv.appendChild(clonedElement);
                            }
                        });

                        const sectionCanvas = await html2canvas(tempDiv, {
                            scale: 3, // Increased scale for sharper text and images in PDF
                            useCORS: true,
                            logging: false
                        });

                        const sectionImgData = sectionCanvas.toDataURL('image/png');

                        // Remove the temporary div
                        document.body.removeChild(tempDiv);

                        const sectionImgWidth = A4_WIDTH_MM;
                        const sectionImgHeight = (sectionCanvas.height * sectionImgWidth) / sectionCanvas.width;

                        // Add a new page for each group (except the very first one)
                        if (i > 0) {
                            pdf.addPage();
                        }
                        
                        // Add logo to the top of each page
                        pdf.addImage(LOGO_BASE64, 'PNG', LOGO_X_POS_MM, LOGO_Y_POS_MM, LOGO_WIDTH_MM, LOGO_HEIGHT_MM);

                        // If the captured group image is taller than an A4 page, slice it across multiple PDF pages
                        if (sectionImgHeight > (A4_HEIGHT_MM - PDF_MARGIN_TOP_CONTENT - LOGO_HEIGHT_MM - LOGO_Y_POS_MM)) { // Account for logo and content margin
                            let currentRenderPosition = 0;
                            // Remaining height after logo and its margin
                            const availableHeightForContent = A4_HEIGHT_MM - LOGO_HEIGHT_MM - LOGO_Y_POS_MM - PDF_MARGIN_TOP_CONTENT;
                            while (currentRenderPosition < sectionImgHeight) {
                                if (currentRenderPosition > 0) { // Add new page for subsequent slices of this large section
                                    pdf.addPage();
                                    // Add logo to new sliced page
                                    pdf.addImage(LOGO_BASE64, 'PNG', LOGO_X_POS_MM, LOGO_Y_POS_MM, LOGO_WIDTH_MM, LOGO_HEIGHT_MM);
                                }
                                // Adjust Y position to include top margin after logo
                                pdf.addImage(sectionImgData, 'PNG', 0, PDF_MARGIN_TOP_CONTENT + LOGO_Y_POS_MM - currentRenderPosition, sectionImgWidth, sectionImgHeight);
                                currentRenderPosition += availableHeightForContent;
                            }
                        } else {
                            // Section fits on one page, add with top margin after logo
                            pdf.addImage(sectionImgData, 'PNG', 0, PDF_MARGIN_TOP_CONTENT + LOGO_Y_POS_MM, sectionImgWidth, sectionImgHeight);
                        }
                    }

                    // Filename generation
                    const dataUtilizacao = dataUtilizacaoInput ? dataUtilizacaoInput.value : ''; //YYYY-MM-DD
                    const tipoEventoSelected = document.querySelector('input[name="tipo_evento"]:checked');
                    const tipoEvento = tipoEventoSelected ? tipoEventoSelected.value : ''; // 'diurno' or 'noturno'
                    const horarioInicio = horarioInicioInput ? horarioInicioInput.value : ''; // HH:MM
                    const horarioFim = horarioFimInput ? horarioFimInput.value : ''; // HH:MM <-- CORRIGIDO AQUI

                    let formattedDate = '';
                    if (dataUtilizacao) {
                        const [year, month, day] = dataUtilizacao.split('-');
                        formattedDate = `${day}${month}${year}`; // DDMMYYYY
                    }

                    let period = ''; // Changed this to use 'DIA' or 'NOITE' directly
                    if (tipoEvento === 'diurno') {
                        period = 'DIA';
                    } else if (tipoEvento === 'noturno') {
                        period = 'NOITE';
                    }

                    let startHour = '';
                    if (horarioInicio) {
                        startHour = horarioInicio.split(':')[0]; // Just the hour
                    }

                    let endHour = '';
                    if (horarioFim) {
                        endHour = horarioFim.split(':')[0]; // Just the hour
                    }

                    const filename = `${formattedDate}${period}-${startHour}-${endHour}.pdf`;

                    pdf.save(filename);
                    
                    horarioInfoSpan.textContent = 'PDF gerado e salvo com sucesso!';


                } catch (error) {
                    console.error('Erro ao gerar PDF:', error);
                    pdfErrorMessage.textContent = 'Erro ao gerar o PDF. Por favor, tente novamente.';
                } finally {
                    // Restore visibility of button and hide loading message
                    enviarContratoBtn.style.display = 'block';
                    loadingMessage.style.display = 'none';
                    enviarContratoBtn.disabled = false;
                }
            });


            // Initial setup on page load
            updateTimeRestrictions(); // Set initial min/max based on default event type and no date
            calculateTotal();
        });
    </script>
</body>
</html>
